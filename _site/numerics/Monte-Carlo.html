<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Monte Carlo Calculation of pi</title>
    <meta name="description" content="Blog Introduction to Computational Condensed Matter Physics">
    <link rel="stylesheet" href="/M4/css/main.css">
    <link rel="canonical" href="/M4/numerics/Monte-Carlo.html">

          <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>


  <body>


    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/M4/">Metals, Magnets, and Miscellaneous Materials</a>

    <!--<nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
      </svg>
    </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/M4/about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/M4/jupyterjulia/">Interacting with Julia</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/M4/tags/Lattices/">Posts Tagged &ldquo;Lattices&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Quantum/">Posts Tagged &ldquo;Quantum&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Exact%20Diagonalization/">Posts Tagged &ldquo;Exact Diagonalization&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Monte%20Carlo/">Posts Tagged &ldquo;Monte Carlo&rdquo;</a>
          
        
      </div>
    </nav>-->

  </div>

</header>




    <div class="page-content">
        <div class="downloadzp"><a href="https://github.com/albi3ro/M4/archive/master.zip" class="sidebar">Zip!</a></div>

        <div class="clonelink"><a href="https://github.com/albi3ro/M4.git" class="sidebar">Clone!</a></div>

        <div class="juliadocs"><a href="http://docs.julialang.org/en/latest/manual/" class="sidebar">Docs</a></div>

        <div class="juliahelp"><a href="/M4/jupyterjulia" class="sidebar">Interact</a></div>

        <div class="about"><a href="/M4/about" class="sidebar">About</a></div>

      <div class="wrapper">
        <div class="post">

  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  <header class="post-header">
    <h1 class="post-title">Monte Carlo Calculation of pi</h1>
    <p class="post-meta">Author: Christina C. Lee &nbsp;&nbsp;&nbsp;&nbsp;
      Category: <a href="/M4/categories">Numerics</a> &nbsp;  &nbsp; &nbsp; &nbsp; Tags:
      
      <a href="/M4/tags">Monte Carlo</a></p>
        
  </header>

  <article class="post-content">

    <h2 id="monte-carlo--random-numbers-to-improve-calculations">Monte Carlo- Random Numbers to Improve Calculations</h2>

<p>When one hears “Monte Carlo”, most people might think of something like this:</p>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/871.jpg" alt="Monte Carlo" />
    
    
        <p class="image-caption">My Mom and I touring Monte Carlo, Monaco.</p>
    
</div>

<p>Monte Carlo, Monaco: known for extremely large amounts of money, car racing, no income taxes,and copious gambling.</p>

<p>In addition to Monaco, Europe, Las Vegas decided to host a Monte Carlo-themed casino as well.  So during the Manhattan project, when the best minds in the United States were camped out in the New Mexican desert, they had plenty of inspiration from Las Vegas, and plenty of difficult problems to work on in the form of quantifying the inner workings of nuclei.  Enrico Fermi first played with these ideas, but Stanislaw Ulam invented the modern Monte Carlo Markov Chain later.</p>

<p>At the same time, these scientists now had computers at their disposal.  John von Neumann programmed Ulam’s algorithm onto ENIAC, Electronic Numerical Integrator and Computer, the very first electronic, general purpose computer, even though it did still run on vacuum tubes.</p>

<p>That still doesn’t answer, why do random numbers actually help us solve problems?</p>

<p>Imagine you are visiting a new city for the first time, maybe Monte Carlo. You only have a day or two, and you want to really get to know the city.  You have two options for your visit</p>

<ul>
  <li>Hit the tourist sites you researched online</li>
  <li>Wander around.  Try and communicate with the locals.  Find an out-of-the-way restaurant and sample food not tamed for foreigners.  Watch people interact.  Get lost.</li>
</ul>

<p>Both are legitimate ways to see the city.  But depending on what you want, you might choose a different option.  The same goes for exploring physics problems.  Sometimes you want to go in and study just everything you knew about beforehand, but sometimes you need to wander around, not hit everything, but get a better feeling for what everything might be like.</p>

<h2 id="buffons-needle-calculation-of-">Buffon’s Needle: Calculation of π</h2>
<p>Even back in the 18th century, Georges-Louis Leclerc, Comte de Buffon posed a problem in geometric probability.  Nowdays, we use a slightly different version of that problem to calculate π and illustrate Monte Carlo simulations.</p>

<p>Suppose we have a square dartboard, and someone with really bad, completely random aim, even though he/she always at least hits inside the dartboard.  We then inscribe a circle inside that dartboard. After an infinity number of hits, what is the ratio between hits in the circle, and hits in the square?</p>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/dartboard.png" alt="dartboard" />
    
    
        <p class="image-caption">Randomly thrown darts than can either be in the circle or not.</p>
    
</div>

<script type="math/tex; mode=display">f= \frac{N_{circle}}{N_{square}} =\frac{\text{Area of circle}}{\text{Area of square}} =\frac{\pi r^2}{4 r^2}= \frac{\pi}{4}</script>

<script type="math/tex; mode=display">\pi = 4 f</script>

<h2 id="onto-the-code">Onto the Code!</h2>

<pre><code class="language-julia">#Pkg.update()
#Pkg.add("PyPlot")
using PyPlot
</code></pre>

<p>We will generate our random numbers on the unit interval.  Thus the radius in our circumstance is $.5$.</p>

<p>Write a function <code class="highlighter-rouge">incircle(r2)</code> such that if <code class="highlighter-rouge">r2</code> is in the circle, it returns true, else, it returns false.  We will use this with the julia function <code class="highlighter-rouge">filter</code>.  Assume <code class="highlighter-rouge">r2</code> is the radius squared, and already centered around the middle of the unit circle</p>

<pre><code class="language-julia">function incircle(r2)
    if r2&lt;.25
        return true
    else
        return false
    end
end
</code></pre>

<pre><code class="language-julia">#The number of darts we will throw at the board.  We will see how accurate different numbers are
N=[10,25,50,75,100,250,500,750,1000,2500,5000,7500,10000];
# We will perform each number multiple times in order to calculate error bars
M=15;
</code></pre>

<pre><code class="language-julia">πapprox=zeros(Float64,length(N),M);

for ii in 1:length(N)
    #initialize an array of proper size
    X=zeros(Float64,N[ii],2);
    for jj in 1:M

        #popular our array with random numbers on the unit interval
        rand!(X);

        #calculate their radius squared
        R2=(X[:,1]-.5).^2+(X[:,2]-.5).^2

        # 4*number in circle / total number
        πapprox[ii,jj]=4.*length(filter(incircle,R2))/N[ii];

    end
end
</code></pre>

<pre><code class="language-julia"># Get our averages and standard deviations
πave=sum(πapprox,2)/M;
πstd=std(πapprox,2);
</code></pre>

<h2 id="analysis">Analysis</h2>

<p>So that was a nice, short little piece of code.  Lets plot it now to see means.</p>

<pre><code class="language-julia">title("Monte Carlo Estimation of π")
ylabel("π estimate")
xlabel("N points")
plot(N,π*ones(N));

for j in 1:M
    scatter(N,πapprox[:,j],marker="o",color="green");
end
ax=gca()
errorbar(N,π*ones(N),yerr=πstd,color="red",fmt="o")
ax[:set_xscale]("log");
ax[:set_xlim]([5,5*10^4]);
</code></pre>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/piestimation2.png" alt="Result" />
    
    
        <p class="image-caption">Image result.  I inverted the color scale though.</p>
    
</div>

<p>When we have fewer numbers of points, our estimates vary much more wildly, and much further from 3.1415926 .
But, at least, the guesses from our different runs all seem equally distributed around the correct value, so it seems we have no systematic error.</p>

<p>As we get up to $10^4$, our estimate starts getting much more accurate and consistent.</p>

<pre><code class="language-julia">title("Dependence of Monte Carlo Error on Number of Points")
ylabel("standard deviation")
xlabel("N points")
semilogx(N,πstd,marker="o");
</code></pre>
<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/error.png" alt="Result" />
    
    
        <p class="image-caption">Image result. Colors tweaked.</p>
    
</div>

<p>So what we guessed in the first plot about dispersion in estimate, we quantify here in this plot.  When we only have 10 darts, the guesses vary by up to .3, but when we get down to 1,000 trials, we are starting to be consistent to .0002</p>

<pre><code class="language-julia">title("Overall Averages")
xlabel("N steps")
ylabel("Average of 15 runs")
semilogx(N,π*ones(N));
semilogx(N,πave,marker="o");
</code></pre>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/ave.png" alt="Result" />
    
    
        <p class="image-caption">Image result. Colors tweaked.</p>
    
</div>

<p>Now lets just make a graphical representation of what we’ve been doing this whole time.  Plot our points on unit square, and color the ones inside a circle a different color.</p>

<pre><code class="language-julia">X=zeros(Float64,1000);
Y=zeros(Float64,1000);
rand!(X);
rand!(Y);
R2=(X-.5).^2+(Y-.5).^2;
Xc=[];
Yc=[]
for ii in 1:length(X)
    if R2[ii]&lt;.25
        push!(Xc,X[ii]);
        push!(Yc,Y[ii]);
    end
end

title("The dartboard")
xlim(0,1)
ylim(0,1)
scatter(X,Y);
scatter(Xc,Yc,color="red");
</code></pre>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/dartboardpyplot.png" alt="Result" />
    
    
        <p class="image-caption">Result. Colors tweaked</p>
    
</div>

<p>That’s all folks!
Now here’s a picture of some pie to congratulate you on calculating π.
<!-- _includes/image.html --></p>
<div class="image-wrapper">
    
        <img src="/M4/Images/MonteCarlo/pie.jpg" alt="pie" />
    
    
        <p class="image-caption">
By Scott Bauer, USDA ARS - This image was released by the Agricultural Research Service, the research agency of the United States Department of Agriculture, with the ID K7252-47 (next).This tag does not indicate the copyright status of the attached work. A normal copyright tag is still required. See Commons:Licensing for more information.English | français | македонски | +/−, Public Domain, https://commons.wikimedia.org/w/index.php?curid=264106</p>
    
</div>


  </article>

</div>

      </div>
    </div>

    <div class="comment">
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'M4julia'; // required: replace example with your forum shortname
  var disqus_identifier = "/numerics/Monte-Carlo.html";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Metals, Magnets, and Miscellaneous Materials</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Metals, Magnets, and Miscellaneous Materials</li>
          <li><a href="mailto:chrissie.c.l@gmail.com">chrissie.c.l@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Blog Introduction to Computational Condensed Matter Physics</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70984222-1', 'auto');
  ga('send', 'pageview');

</script>
